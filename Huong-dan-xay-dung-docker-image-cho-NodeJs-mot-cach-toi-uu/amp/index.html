<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
    <link rel="canonical" href="https://ntpntp1997.github.io/Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu/" >
    <title>Hướng dẫn xây dựng docker image cho NodeJs một cách tối ưu - Blog Developer</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    
    <meta property="og:title" content="Hướng dẫn xây dựng docker image cho NodeJs một cách tối ưu">
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://ntpntp1997.github.io/Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu/">
	
		<meta property="og:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	<meta property="og:site_name" content="Blog Developer">
	
		<meta property="og:description" content="Khi công việc kinh doanh cần tới nhiều ứng dụng web khác nhau, khi mà bây giờ framework hay ngôn ngữ lập trình chỉ là công cụ. Các công ty không bị giới hạn và có thể sử dụng bất kỳ ngôn ngữ nào cần. Vì vậy chúng ta cần có một môi trường mà nhiều ứng dụng khác nhau có thể chạy cùng nhau trên đó.
Virtual Machines (VM) cho phép chúng ta chạy nhiều app trên cùng 1 server. Nhưng cũng có hạn chế. Mỗi VM cần toàn bộ OS để chạy. Mỗi OS lại cần CPU, RAM,… để chạy, rồi nó cần patching và licensing, do đó làm tăng chi phí và khả năng phục hồi.">
	
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="Blog Developer">
	<meta name="twitter:url" content="https://ntpntp1997.github.io/Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu/">
	<meta name="twitter:title" content="Hướng dẫn xây dựng docker image cho NodeJs một cách tối ưu - Blog Developer">
	
		<meta name="twitter:description" content="Khi công việc kinh doanh cần tới nhiều ứng dụng web khác nhau, khi mà bây giờ framework hay ngôn ngữ lập trình chỉ là công cụ. Các công ty không bị giới hạn và có thể sử dụng bất kỳ ngôn ngữ nào cần. Vì vậy chúng ta cần có một môi trường mà nhiều ứng dụng khác nhau có thể chạy cùng nhau trên đó.
Virtual Machines (VM) cho phép chúng ta chạy nhiều app trên cùng 1 server. Nhưng cũng có hạn chế. Mỗi VM cần toàn bộ OS để chạy. Mỗi OS lại cần CPU, RAM,… để chạy, rồi nó cần patching và licensing, do đó làm tăng chi phí và khả năng phục hồi.">
	
    
    	<meta name="twitter:image" content="/amp-dist/sample/sample-substituteTitleImage.png">
	
	
	
    
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    <!--
  	<script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>
    -->
    
    
    
    
    
    
    
    
    
    
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "BlogPosting",
			"headline": "Hướng dẫn xây dựng docker image cho NodeJs một cách tối ưu",
			
			"description": "Khi công việc kinh doanh cần tới nhiều ứng dụng web khác nhau, khi mà bây giờ framework hay ngôn ngữ lập trình chỉ là công cụ. Các công ty không bị giới hạn và có thể sử dụng bất kỳ ngôn ngữ nào cần. Vì vậy chúng ta cần có một môi trường mà nhiều ứng dụng khác nhau có thể chạy cùng nhau trên đó.
Virtual Machines (VM) cho phép chúng ta chạy nhiều app trên cùng 1 server. Nhưng cũng có hạn chế. Mỗi VM cần toàn bộ OS để chạy. Mỗi OS lại cần CPU, RAM,… để chạy, rồi nó cần patching và licensing, do đó làm tăng chi phí và khả năng phục hồi.",
			
			"mainEntityOfPage":{
			    "@type":"WebPage",
			    "@id":"https://ntpntp1997.github.io/Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu/"
			},
			"datePublished": "2020-05-06T08:26:10.000Z",
			"dateModified": "2020-05-11T09:34:02.744Z",
			
			"image": {
				"@type": "ImageObject",
				"url": "/amp-dist/sample/sample-substituteTitleImage.png",
				"width" : "1024",
				"height" : "800"
			},
			
			"author": {
			    "@type": "Person",
			    "name": "Thanh Phuong"
			},
			"publisher": {
			    "@type": "Organization",
			    "name": "Blog Developer"
			    
			    ,
			    "logo": {
			      "@type": "ImageObject",
			      "url": "https://ntpntp1997.github.io/amp-dist/sample/sample-logo.png",
			      "width": 600,
			      "height": 60
			    }
			    
			}
		}
	</script>
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
	
	<style amp-custom>
		
abbr,
acronym,
address,
applet,
big,
blockquote,
body,
caption,
cite,
code,
dd,
del,
dfn,
div,
dl,
dt,
em,
fieldset,
form,
h1,
h2,
h3,
h4,
h5,
h6,
html,
iframe,
img,
ins,
kbd,
label,
legend,
li,
object,
ol,
p,
pre,
q,
s,
samp,
small,
span,
strike,
strong,
sub,
sup,
table,
tbody,
td,
tfoot,
th,
thead,
tr,
tt,
ul,
var {
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
abbr {
  cursor: help;
  border-bottom: 1px dotted;
  font-variant: normal;
}
acronym {
  border-bottom: 1px dotted;
  font-variant: normal;
}
body {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  -webkit-text-size-adjust: 100%;
  background: #fff;
  color: #2d3d40;
  font-family: sans-serif;
  font-size: 1rem;
  font-weight: 500;
  line-height: 2rem;
  text-rendering: optimizelegibility;
}
button::-moz-focus-inner,
input::-moz-focus-inner,
figure.highlight td,
.post .entry-content figure.highlight th {
  border: 0;
  padding: 0;
}
caption,
table,
td,
th {
  vertical-align: middle;
}
caption,
td,
th,
.table-align-left {
  text-align: left;
}
del {
  text-decoration: line-through;
}
html {
  font-size: 14px;
}
:root sub,
:root sup {
  vertical-align: baseline;
}
table {
  border-collapse: separate;
  border-spacing: 0;
}
a {
  color: #e91e63;
  text-decoration: none;
  -webkit-transition: 0.7s;
  -ms-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -webkit-transition: 0.7s;
  -moz-transition: 0.7s;
  -o-transition: 0.7s;
  -ms-transition: 0.7s;
  transition: 0.7s;
  border: 0;
  font-family: inherit;
  font-size: 1rem;
  font-style: inherit;
  font-weight: inherit;
  margin: 0;
  outline: 0;
  padding: 0;
  vertical-align: baseline;
}
a img {
  border: none;
}
a:hover {
  -webkit-transition: 0.2s;
  -ms-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -webkit-transition: 0.2s;
  -moz-transition: 0.2s;
  -o-transition: 0.2s;
  -ms-transition: 0.2s;
  transition: 0.2s;
  color: #930e3b;
}
@media (min-width: 481px) {
  html {
    font-size: 16px;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  html {
    font-size: 14px;
  }
}
.clearfix:after {
  clear: both;
  visibility: hidden;
  content: ".";
  display: block;
  height: 0;
}
.left {
  float: left;
}
.right {
  float: right;
}
.circle {
  -webkit-border-radius: 50%;
  border-radius: 50%;
}
.thumbImg-w {
  width: 100px;
  height: 100px;
  display: inline-block;
  position: relative;
  overflow: hidden;
}
.thumbImg {
  top: 50%;
  left: 50%;
  position: absolute;
  -webkit-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  -webkit-transform: translate(-50%, -50%);
  -moz-transform: translate(-50%, -50%);
  -o-transform: translate(-50%, -50%);
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xmlutf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#4A4A4A\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.nav ul:after {
  clear: both;
  visibility: hidden;
}
.nav,
.nav-icon {
  position: relative;
}
.nav ul {
  display: block;
}
.nav ul li {
  display: block;
}
.nav ul li a {
  display: block;
}
.tab {
  position: relative;
  color: #424242;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 200px;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li a {
  display: block;
  padding: 10px 20px;
}
header {
  height: 60px;
  background-color: #222f31;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
  -webkit-box-shadow: 0 -1px 0 #3c5155 inset, 0 -3px 0 #1e292b inset;
}
header .header-title a {
  padding: 0 0 0 20px;
  height: 60px;
  line-height: 60px;
  font-size: 20px;
  color: #fff;
  letter-spacing: 0.2em;
}
header .nav-container {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-box-pack: justify;
  -moz-box-pack: justify;
  -o-box-pack: justify;
  -ms-flex-pack: justify;
  -webkit-justify-content: space-between;
  justify-content: space-between;
}
header .left-nav {
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: center;
  -ms-flex-align: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  font-size: 20px;
  margin-left: 0;
  font-weight: 300;
  -webkit-box-pack: start;
  -ms-flex-pack: start;
  -webkit-box-pack: start;
  -moz-box-pack: start;
  -o-box-pack: start;
  -ms-flex-pack: start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -webkit-box-flex: 1;
  -ms-flex: 1 1 auto;
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  -o-box-flex: 1;
  box-flex: 1;
  -webkit-flex: 1 1 auto;
  -ms-flex: 1 1 auto;
  flex: 1 1 auto;
  text-align: left;
  width: auto;
  font-size: 15px;
}
header .right {
  font-size: 15px;
}
header .alt {
  padding: 0;
  text-align: right;
  display: -webkit-box;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-box-align: stretch;
  -moz-box-align: stretch;
  -o-box-align: stretch;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.blog-title a {
  position: relative;
}
button {
  -webkit-box-align: start;
  -moz-box-align: start;
  -o-box-align: start;
  -ms-flex-align: start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  text-align: center;
  cursor: default;
  color: buttontext;
  background-color: buttonface;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
  padding: 2px 6px 3px;
  border-width: 2px;
  border-style: outset;
  border-color: buttonface;
  -webkit-border-image: initial;
  -moz-border-image: initial;
  -o-border-image: initial;
  border-image: initial;
  text-rendering: auto;
  color: initial;
  letter-spacing: normal;
  word-spacing: normal;
  text-transform: none;
  text-indent: 0px;
  text-shadow: none;
  display: inline-block;
  text-align: start;
  margin: 0em 0em 0em 0em;
  font: 11px system-ui;
  -webkit-writing-mode: horizontal-tb;
  -webkit-appearance: button;
}
.__web-inspector-hide-shortcut__ {
  visibility: hidden ;
}
.hamburger {
  display: inline-block;
  background-color: transparent;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"-3 -6 24 24\"><path fill=\"#FFF\" d=\"M0 12h18v-2H0v2M0 7h18V5H0v2M0 0v2h18V0H0\"/></svg>");
  background-repeat: no-repeat;
  -webkit-background-size: 30px 24px;
  -moz-background-size: 30px 24px;
  background-size: 30px 24px;
  background-position: center center;
  border: none;
  margin: 0;
  padding: 0;
  width: 60px;
  height: 60px;
  cursor: pointer;
  -ms-flex-item-align: center;
  -ms-grid-row-align: center;
  -webkit-align-self: center;
  align-self: center;
  -ms-flex-item-align: center;
}
.tab {
  position: relative;
  color: #2d3d40;
  padding: 6px;
  margin: 0 4px;
  text-decoration: none;
  text-transform: uppercase;
  font-weight: 400;
  -webkit-transition: 0.1s ease color;
  -webkit-transition: 0.1s ease color;
  -moz-transition: 0.1s ease color;
  -o-transition: 0.1s ease color;
  -ms-transition: 0.1s ease color;
  transition: 0.1s ease color;
}
amp-sidebar {
  width: 250px;
  background-color: #182022;
}
amp-sidebar ul {
  padding: 10px 0;
}
amp-sidebar li {
  border-top: 1px solid #2f4043;
}
amp-sidebar li:last-child {
  border-bottom: 1px solid #2f4043;
}
amp-sidebar li a {
  color: #fff;
  font-weight: bold;
  display: block;
  padding: 10px 20px;
}
amp-sidebar li a:hover {
  color: #ccc;
  background-color: #030404;
}
.categories-header {
  background-color: #2d3d40;
  padding: 0rem 0.8rem;
}
.categories-header a {
  color: #fff;
}
.categories-header a:hover {
  color: #fff;
}
.categories-header .breadcrumb ol li {
  list-style: none;
  display: inline-block;
  margin: 0;
}
.categories-header .breadcrumb ol li span {
  font-size: 0.8rem;
  font-weight: bold;
}
.categories-header .breadcrumb ol li:after {
  content: "/";
  color: #fff;
  display: inline-block;
  margin: 0 0.4rem;
}
.categories-header .breadcrumb ol li:last-child:after {
  content: "";
  margin: 0;
}
.entry-header {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.entry-header .flx:first-child {
  margin: 0 1rem 0 0;
}
.header-cap {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.title-cover {
  background-color: #fff;
  color: #2d3d40;
  padding: 1.5rem 0.8rem 0 0.8rem;
}
.title-cover a {
  font-size: 1.2rem;
  color: #2d3d40;
  text-align: left;
  font-weight: bold;
}
.entry-title {
  margin: 0;
}
.entry-meta-header {
  font-size: 0.85rem;
  text-align: center;
}
.entry-meta-header .date {
  font-family: sans-serif;
}
h1 a,
h2 a,
h3 a,
h4 a,
h5 a,
h6 a {
  color: #2d3d40;
  text-decoration: none;
}
h1 a:hover,
h2 a:hover,
h3 a:hover,
h4 a:hover,
h5 a:hover,
h6 a:hover {
  color: #e91e63;
}
#container {
  margin-left: auto;
  margin-right: auto;
}
#main {
  margin-bottom: 3em;
  padding-left: 0;
}
.post {
  margin-bottom: 3rem;
  position: relative;
}
.entry-content {
  margin: 0 0.6rem;
  font-size: 1rem;
}
.entry-content h1 {
  font-size: 1.7rem;
  line-height: 1.5;
  margin: 1em 0 0.8em;
}
.entry-content h2,
.entry-content h3,
.entry-content h4,
.entry-content h5,
.entry-content h6,
.entry-content h2 span,
.entry-content h3 span,
.entry-content h4 span,
.entry-content h5 span,
.entry-content h6 span {
  color: #98b8be;
  font-weight: bold;
}
.entry-content h2,
.entry-content h2 span {
  font-size: 1.8rem;
  line-height: 2.6rem;
  text-align: center;
}
.entry-content h2 {
  border-bottom: 2px solid #cce4e8;
  margin: 4.5rem 0 0.5em;
  padding: 0.8em 0;
}
.entry-content h3,
.entry-content h3 span {
  font-size: 1.6rem;
  line-height: 2.2rem;
  text-align: center;
}
.entry-content h3 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h4,
.entry-content h4 span {
  font-size: 1.4rem;
  line-height: 2rem;
  text-align: center;
}
.entry-content h4 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h5,
.entry-content h5 span {
  font-size: 1.2rem;
  line-height: 1.8rem;
  text-align: center;
}
.entry-content h5 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content h6,
.entry-content h6 span {
  font-size: 1.1rem;
  line-height: 1.6rem;
  text-align: center;
}
.entry-content h6 {
  margin: 3.6rem 0.8rem 3rem 0.8rem;
  padding: 0;
}
.entry-content p {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2.2rem;
  margin: 3rem 0.8rem;
}
.entry-content p a {
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: inline;
  border-bottom: 1px dashed #f1729d;
  padding-bottom: 0.3rem;
}
.entry-content p a:hover {
  border-bottom: 1px dashed #9c0f3f;
  padding-bottom: 0.4rem;
}
.entry-content em {
  background-color: #f9f5d1;
  color: #886d00;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
}
.entry-content strong {
  color: #871c1c;
  font-style: normal;
  margin: 0 2px;
  padding: 0.4em;
  background-color: #fadcdc;
}
.entry-content hr {
  border: 0;
  border-top: 3px solid #cce4e8;
  margin: 3rem auto;
  width: 20%;
}
.entry-content img,
.entry-content video {
  display: block;
  height: auto;
  margin: auto;
  max-width: 100%;
}
.entry-content iframe {
  width: 100% ;
}
.entry-content blockquote {
  margin: 3rem 0.8rem;
  padding: 1rem 1.8rem;
  position: relative;
  background-color: none;
  border-left: 3px solid #98b8be;
  font-style: italic;
}
.entry-content blockquote p {
  margin: 0.5rem 0;
}
.entry-content blockquote blockquote {
  border-left: none;
}
.entry-content .table-wrapper {
  margin: 3rem 0.8rem;
}
.entry-content table {
  border-collapse: collapse;
  border-spacing: 0;
  overflow: auto;
  display: block;
  font-size: 0.85rem;
  margin: 0 auto;
  width: auto;
}
.entry-content td,
.entry-content th {
  line-height: 1.8em;
  padding: 0.8rem 0.8rem;
  font-size: 0.85rem;
}
.entry-content td em,
.entry-content th em,
.entry-content td strong,
.entry-content th strong,
.entry-content td a,
.entry-content th a {
  font-size: 0.85rem;
}
.entry-content td {
  border: 1px solid #c4c4c4;
}
.entry-content th {
  background-color: #ecf5f7;
  border: 1px solid #c4c4c4;
}
.entry-content .table-align-center {
  text-align: center;
}
.entry-content .table-align-right {
  text-align: right;
}
.entry-content ul,
.entry-content ol,
.entry-content dl {
  margin: 3rem 0 3rem 1.6rem;
  padding: 0;
  list-style: none;
  font-size: 1rem;
}
.entry-content ul li,
.entry-content ol li,
.entry-content dl li {
  line-height: 2rem;
  position: relative;
  padding: 0;
}
.entry-content ul li p,
.entry-content ol li p,
.entry-content dl li p {
  line-height: 2rem;
  margin: 0;
}
.entry-content ul li p:not(:first-child),
.entry-content ol li p:not(:first-child),
.entry-content dl li p:not(:first-child) {
  color: #57767c;
  margin: 0.5rem;
}
.entry-content ul li ul,
.entry-content ol li ul,
.entry-content dl li ul,
.entry-content ul li ol,
.entry-content ol li ol,
.entry-content dl li ol,
.entry-content ul li dl,
.entry-content ol li dl,
.entry-content dl li dl {
  margin: 1rem;
}
.entry-content ul li {
  margin: 0.4rem 0 0.4rem 0.8rem;
}
.entry-content ul li::after {
  position: absolute;
  display: block;
  content: '';
  top: 0.75rem;
  left: -1rem;
  width: 0.5rem;
  height: 0.5rem;
  background-color: #cce4e8;
  border-radius: 100%;
}
.entry-content ol {
  counter-reset: number;
}
.entry-content ol li {
  margin: 0.4rem 0 0.4rem 2rem;
}
.entry-content ol li p:first-child {
  display: inline-block;
  line-height: 1.6rem;
  height: 1.6rem;
}
.entry-content ol li:before {
  position: absolute;
  display: inline-block;
  float: left;
  margin: 0 0.2rem 0 0;
  padding: 0;
  counter-increment: number;
  content: counter(number);
  left: -2.2rem;
  top: 0.2rem;
  background-color: #98b8be;
  width: 1.6rem;
  height: 1.6rem;
  border-radius: 50%;
  color: #fff;
  text-align: center;
  font-weight: bold;
  font-size: 0.8rem;
  line-height: 1.6rem;
}
kbd {
  font-family: sans-serif;
  text-align: center;
  display: inline-block;
  color: #425a5e;
  -moz-osx-font-smoothing: grayscale;
  -webkit-border-radius: 3px;
  -webkit-box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  box-shadow: 0 0 10px #e8e8e8 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-box-shadow: 0 0 10px #e2e2e2 inset, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 3px 3px #333;
  -webkit-font-smoothing: subpixel-antialiased;
  background: #fff;
  border-left: 1px solid #fff;
  border-radius: 3px;
  border-right: 1px solid #e6e6e6;
  border-top: 1px solid #fff;
  font-size: 0.85rem;
  line-height: 1rem;
  margin: 5px;
  padding: 6px 8px 3px;
  text-shadow: 0 1px 0 #fff;
  vertical-align: baseline;
  
}
img.responsive-img {
  height: auto;
  max-width: 100%;
}
video.responsive-video {
  height: auto;
  max-width: 100%;
}
amp-instagram,
amp-vimeo,
amp-video,
amp-youtube,
amp-twitter,
.soundcloud-wrapper,
.amp-img-wrapper,
.googleAdPost,
.ad-footer {
  margin: 3rem 0.8rem;
}
code,
figure.highlight .code,
pre {
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: subpixel-antialiased;
}
code,
pre,
samp {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
}
p code {
  font-size: 1rem;
}
code,
pre {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  background-color: #ecf5f7;
  color: #007e96;
}
code {
  margin: 0 3px;
  padding: 0.4em;
}
samp {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
sub,
sup {
  font-size: 0.75rem;
  line-height: 0;
  position: relative;
}
sub {
  bottom: -0.2em;
}
sup {
  top: -0.5em;
}
pre {
  font-size: 1rem;
  letter-spacing: 0.05rem;
  margin: 0 3px;
  padding: 15px;
  -webkit-background-clip: padding;
  -moz-background-clip: padding;
  background-clip: padding-box;
  border: 0;
  line-height: 1.3rem;
  overflow-x: auto;
}
pre .addition,
pre .css .tag,
pre .keyword,
pre .method,
pre .nginx .title,
pre .request,
pre .status,
pre .winutils {
  color: #66d9ef;
}
pre .attr_selector,
pre .cdata,
pre .clojure .title,
pre .diff .change,
pre .important {
  color: #9882eb;
}
pre .preprocessor {
  color: #9882eb;
}
pre .preprocessor .keyword {
  color: #9882eb;
}
pre .shebang,
pre .special,
pre .subst {
  color: #9882eb;
}
pre .symbol {
  color: #9882eb;
}
pre .symbol .string {
  color: #9882eb;
}
pre .attribute,
pre .class .title,
pre .constant,
pre .haskell .type,
pre .lisp .body,
pre .parent,
pre .smalltalk .number,
pre .variable {
  color: #a6e22e;
}
pre .built_in,
pre .chunk,
pre .decorator,
pre .id,
pre .identifier,
pre .literal,
pre .localvars,
pre .title,
pre .vhdl,
pre .deletion {
  color: #f92672;
}
pre .command,
pre .hexcolor,
pre .number,
pre .phpdoc,
pre .regexp,
pre .string,
pre .tag .value,
pre .tex .formula {
  color: #e6db74;
}
pre .comment,
pre .diff .header,
pre .doctype,
pre .javadoc,
pre .lisp .string,
pre .pi,
pre .template_comment {
  color: #75715e;
  font-weight: normal;
}
.line {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  color: #f8f8f2;
}
.line span {
  font-size: 0.85rem;
  letter-spacing: 0.05rem;
}
.gist {
  background: #fff;
  border: 1px solid color-gutter;
  color: #f8f8f2;
  line-height: 1.6rem;
  margin-top: 15px;
  overflow: auto;
  padding: 7px 15px;
}
.gist .gist-file {
  border: none;
  font-family: inherit;
  font-size: 1rem;
  letter-spacing: 0;
  margin: 0;
}
.gist .gist-file .gist-data {
  background: 0 0;
  border-bottom: none;
}
.gist .gist-file .gist-data pre {
  font-family: Menlo, Consolas, Monaco, Consolas, monospace;
  padding: 0 ;
}
.gist .gist-file .gist-meta {
  background: 0 0;
  color: #f8f8f2;
  font-size: 1rem;
  margin-top: 5px;
  padding: 0;
}
.gist .gist-file .gist-meta a {
  color: #f8f8f2;
}
.gist .gist-file .gist-meta a:visited {
  color: #f8f8f2;
}
figure.highlight {
  font-size: 0.95rem;
  margin: 3rem 0.8rem;
  background: #263338;
  border: 1px solid color-gutter;
  line-height: 2rem;
  overflow: auto;
  position: relative;
}
figure.highlight .code {
  padding: 0 1em 1em 1em;
  color: #f8f8f2;
}
figure.highlight .gutter {
  display: none;
}
figure.highlight figcaption {
  font-size: 1rem;
  font-weight: bold;
  color: #e9e9d6;
  background-color: #1e282c;
  padding: 0.6em 1em;
}
figure.highlight figcaption a {
  position: absolute;
  right: 1rem;
}
figure.highlight figcaption:before {
  content: "\f121";
  font-family: "fontawesome";
  text-align: center;
  display: inline-block;
  margin-right: 0.6em;
}
figure.highlight pre {
  background: 0 0;
  border: none;
  margin: 0;
  padding: 0.5rem;
}
figure.highlight table {
  border-spacing: 0;
  margin: 0;
}
figure.highlight th {
  border: 0;
  font-weight: 400;
  padding: 0;
}
figure.highlight td {
  border: 0;
  font-size: 1.1rem;
  padding: 0;
}
.entry-content .toc {
  background: #fff;
  padding: 0.5rem;
  margin: 3rem 0;
  border: 1px solid #cce4e8;
  border-radius: 2px;
}
.entry-content .toc ul {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
  border-radius: 2px;
}
.entry-content .toc ul:first-child {
  border-top: none;
}
.entry-content .toc ul ul,
.entry-content .toc ul ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li {
  padding: 0;
  margin: 0;
  border-top: 1px solid #5d8b93;
}
.entry-content .toc ul li:first-child {
  border-top: none;
}
.entry-content .toc ul li::after,
.entry-content .toc ul li::before {
  content: normal;
}
.entry-content .toc ul li a {
  font-size: 1.2rem;
  font-weight: bold;
  display: block;
  padding: 1rem;
  background-color: #3d5b61;
  color: #fff;
  -webkit-transition: 0.3s;
  -ms-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -webkit-transition: 0.3s;
  -moz-transition: 0.3s;
  -o-transition: 0.3s;
  -ms-transition: 0.3s;
  transition: 0.3s;
}
.entry-content .toc ul li a:hover {
  color: #fff;
  background-color: #2c4145;
}
.entry-content .toc ul li a:before {
  content: "\f02d";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.8rem;
}
.entry-content .toc ul li ul,
.entry-content .toc ul li ol {
  margin-bottom: 0;
  padding: 0;
  margin: 0;
}
.entry-content .toc ul li ul li a,
.entry-content .toc ul li ol li a {
  padding: 0.5rem 0.75rem 0.5rem 2rem;
  font-size: 0.9rem;
  background-color: #416167;
}
.entry-content .toc ul li ul li a:before,
.entry-content .toc ul li ol li a:before {
  content: "\f0da";
  font-family: "fontawesome";
  display: inline-block;
  padding: 0;
  margin: 0;
  margin-right: 0.6rem;
}
.entry-content .toc ul li ul li ul li a,
.entry-content .toc ul li ol li ul li a {
  padding: 0.5rem 0.75rem 0.5rem 4rem;
}
.entry-content .toc ul li ul li ul li a:before,
.entry-content .toc ul li ol li ul li a:before {
  content: none;
}
.meta-content {
  background-color: #fff;
  margin: 1.5rem 0.8rem;
  padding: 0;
  border-top: 1px dotted #cce4e8;
  letter-spacing: 0.05rem;
}
.meta-wrapper {
  margin: 3rem 0.8rem;
  padding: 0;
  background-color: #fff;
}
h6.tag,
h6.categories {
  color: #2d3d40;
  font-size: 0.9rem;
  font-weight: bold;
}
.article-tag-list {
  padding: 0;
}
.article-tag,
.article-tag-list,
.article-categories,
.article-categories-list {
  padding: 0;
  margin: 0;
}
.article-categories {
  margin-bottom: 1.6em;
}
.article-tag-list li,
.article-categories-list li {
  list-style: none;
  display: inline-block;
  padding: 0;
  margin: 0.2rem 0.1rem;
}
.article-tag-list li a,
.article-categories-list li a {
  font-size: 0.8rem;
  font-weight: bold;
  padding: 0.4rem 0.8rem;
  margin: 0;
  background-color: #ecf5f7;
  color: #2d3d40;
  border-radius: 2px;
  display: block;
}
.article-tag-list li a:before,
.article-categories-list li a:before {
  content: "#";
}
.article-tag-list li a:hover,
.article-categories-list li a:hover {
  color: #fff;
  background-color: #2d3d40;
}
.widget {
  margin: 1.5rem 0.8rem;
  padding: 0;
}
.widget-h {
  text-align: center;
  margin: 1.6rem 0;
}
.widget-h h6 {
  color: #fff;
  background-color: #2d3d40;
  display: inline-block;
  padding: 0.4rem 1rem;
  font-size: 0.9rem;
  font-weight: bold;
}
.posts-list li {
  list-style: none;
  margin: 0.8rem 0;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.posts-list li .posts-list-link {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.posts-list li .posts-list-link a {
  color: #2d3d40;
  font-size: 1.1rem;
  font-weight: bold;
}
.posts-list li .posts-list-link a:hover {
  color: #e91e63;
}
.posts-list li .posts-list-meta {
  font-size: 0.7rem;
}
.posts-list li .flx:first-child {
  margin: 0 1rem 0 0;
}
.posts-list li amp-img {
  border-radius: 2px;
}
#footer {
  background-color: #2d3d40;
  color: #fff;
  display: block;
  font-size: 1rem;
  letter-spacing: 0.05rem;
  line-height: 2rem;
  margin: 3rem 0 0 0;
  padding: 0;
}
.site-author-info {
  margin: 0;
  padding: 3rem 1.6rem;
}
.site-author-info h6 {
  font-size: 1rem;
  color: #fff;
  font-weight: bold;
  display: inline-block;
  background-color: #222f31;
  padding: 0.4rem 0.8rem;
}
.site-author-info-wrapper {
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -webkit-align-items: center;
  -webkit-box-align: center;
  -moz-box-align: center;
  -o-box-align: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
}
.site-author-info-wrapper .flx:first-child {
  margin: 0 1rem 0 0;
}
.authorCap-wrapper {
  -webkit-flex-grow: 3;
  -webkit-box-flex: 3;
  -moz-box-flex: 3;
  -o-box-flex: 3;
  -ms-box-flex: 3;
  box-flex: 3;
  -webkit-flex-grow: 3;
  flex-grow: 3;
}
.authorCap {
  font-size: 1.4rem;
  font-weight: bold;
}
.authorReading {
  font-size: 0.7rem;
}
.site-author-desc {
  font-size: 0.8rem;
  line-height: 1.6rem;
  margin: 1.4rem 0;
}
.copyright-tool {
  margin: 0;
  padding: 1.5rem 1.6rem;
  border-top: 1px solid #384b4f;
}
.copyright-notice p {
  font-size: 0.6rem;
  letter-spacing: 0.05rem;
  line-height: 1.2rem;
  color: #8ba8ae;
}
.copyright-title {
  font-size: 1rem;
  text-align: center;
  margin: 0.8rem 0 0.4rem 0;
}
.copyright-license {
  margin: 0.4rem 0 0.8rem 0;
  font-size: 0.7rem;
  text-align: center;
}
.copyright-license a {
  color: #e6e6e6;
  font-size: 0.7rem;
}
.copyright-license a:hover {
  color: #b3b3b3;
}
.sns-link {
  margin: 0;
  text-align: center;
}
.sns-link a {
  display: inline-block;
  font-size: 1.6rem;
  text-align: center;
  width: 2rem;
  height: 2rem;
  line-height: 2rem;
  padding: 0.6rem;
  margin: 0 0.1rem;
  background-color: #222f31;
  color: #fff;
  border-radius: 4px;
}
.sns-link a:hover {
  color: #ccc;
  background-color: #030404;
}
.footer-menu {
  padding: 1.5rem 0.8rem;
  border-top: 1px solid #384b4f;
}
.footer-menu ul li {
  list-style: none;
  margin: 0;
  padding: 0;
}
.footer-menu ul li a {
  display: block;
  padding: 0.6rem;
  margin: 0.2rem 1.6rem;
  font-size: 1rem;
  color: #fff;
  background-color: #222f31;
  border-radius: 4px;
  text-align: center;
  font-weight: bold;
}
.footer-menu ul li a:hover {
  color: #ccc;
  background-color: #030404;
}
.social-share {
  margin: 1.5rem 0.8rem;
  display: -webkit-box;
  display: -moz-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: box;
  display: flex;
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -o-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
}
.social-share amp-social-share,
.social-share .sbtn {
  margin: 5px;
}
.sbtn {
  padding: 0;
  width: 4rem;
  height: 3rem;
  line-height: 3rem;
  color: #fff;
  font-size: 1.2rem;
  text-align: center;
  border-radius: 4px;
}
.sbtn:hover {
  color: #fff;
}
.tw {
  background-color: #1cafe8;
}
.tw:hover {
  background-color: #0f6b8f;
}
.fb {
  background-color: #4f677f;
}
.fb:hover {
  background-color: #283440;
}
.ht {
  background-color: #35acda;
}
.ht:hover {
  background-color: #1a6e8f;
}
.gp {
  background-color: #d56153;
}
.gp:hover {
  background-color: #9c3326;
}
.tb {
  background-color: #465f79;
}
.tb:hover {
  background-color: #212c38;
}
.icon-hatena:before {
  content: "B";
  font-weight: bold;
  font-size: 1.2rem;
}
#totop {
  position: fixed;
  bottom: 2rem;
  right: 1.6rem;
  font-size: 1.2rem;
  z-index: 995;
}
#totop a {
  background: rgba(152,184,190,0.6);
  text-decoration: none;
  color: #fff;
  padding: 0.8rem;
  border-radius: 50%;
}
#totop a:before {
  content: "\f062";
  font-family: "fontawesome";
  font-size: 1.2rem;
}
#totop a:hover {
  text-decoration: none;
  background: #5d8b93;
  color: #fff;
  line-height: 2.3em;
}
@media (min-width: 800px) {
  .title-cover,
  .entry-content,
  .categories,
  .meta-content,
  .site-author-info {
    width: 780px;
    margin: 0 auto;
  }
  .nav-container {
    width: 800px;
    margin: 0 auto;
  }
}
@media (min-width: 0px) and (max-width: 480px) {
  .site-author-info-wrapper {
    display: block;
  }
  .gravatar-area {
    text-align: center;
  }
  .gravatar-area amp-img {
    display: inline-block;
  }
  .entry-content td,
  .entry-content th {
    line-height: 1.8em;
    padding: 0.6rem 0.6rem;
    font-size: 0.5rem;
  }
  .entry-content td em,
  .entry-content th em,
  .entry-content td strong,
  .entry-content th strong,
  .entry-content td a,
  .entry-content th a {
    font-size: 0.5rem;
  }
}

	</style>
	
  </head>
  <body>
  	
  	
  	<!-- google analytics -->
  	
  	<amp-analytics type="googleanalytics" id="google-analytics">
		<script type="application/json">
		{
		  "vars": {
		    "account": "UA-164523547-1"
		  },
		  "triggers": {
		    "trackPageview": {
		      "on": "visible",
		      "request": "pageview"
		    }
		  }
		}
		</script>
	</amp-analytics>
	
  	
  	
  	<!-- menu -->
  	<header>
  		<div class="nav-container">
	  		<div class="left-nav">
	  			<div class="header-title">
	  				<a href="/">Blog Developer</a>
	  			</div>
	  		</div>
	  		
	  	</div>
    </header>
  	
  	
  	<!-- sidebar -->
  	
  	
  	<!-- container -->
  	<div id="container">
	  	<div id="main">
		    <article id="post-Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu" class="post">
		    
		   		<!-- categories and bread crumb -->
		    	
				<div class="categories-header">
					<div class="categories">
						<div class="breadcrumb inline-icon">
							<ol itemscope itemtype="http://schema.org/BreadcrumbList">
							  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
							    <a itemprop="item" href="/">
							    	<span class="sns-icon home-icon"></span>
							        <span itemprop="name"><span class="fa fa-fw fa-home"></span></span>
							    </a>
							    <meta itemprop="position" content="1" />
							  </li>

								
						    		<li itemprop="itemListElement" itemscope
									      itemtype="http://schema.org/ListItem">
									    <a itemprop="item" href="/categories/Docker/">
									      
									      	<span class="sns-icon folder-icon"></span>
									      
									      <span itemprop="name">Docker</span>
									    </a>
									    <meta itemprop="position" content="2" />
									</li>
								
							</ol>
						</div>
					</div>
				</div>
				
		    
		    	<!-- entry title -->
				<div class="title-cover">
					<div class="entry-header">
						
						
						
			          	<div class="header-thumb flx">
			          		<div class="thumbImg-w circle">
			          			<amp-img class="thumbImg" layout="fixed" width="128" height="100" src="/amp-dist/sample/sample-substituteTitleImage.png">
			          			</amp-img>
			          		</div>
			          	</div>
			            
			            
			            <div class="header-cap flx">
							
							  <h1 class="article-title entry-title" itemprop="name">
							    <a href="https://ntpntp1997.github.io/Huong-dan-xay-dung-docker-image-cho-NodeJs-mot-cach-toi-uu/" target="_blank" itemprop="url">Hướng dẫn xây dựng docker image cho NodeJs một cách tối ưu</a>
							  </h1>
							
						</div>
					</div>
					
					<!-- datePublished -->
					<div class="entry-meta-header">
						<span class="meta-elements date">
							<span class="fa fa-fw fa-clock-o"></span>
							<time datetime="2020-05-06" itemprop="datePublished">2020.05.06</time>
						</span>
					</div>
				</div>
				
				
				
				<!-- entry content -->
			    <div class="entry-content ecp">
			    	<!-- social share button -->
			    	
			    	
			    	
                    <!-- google Adsense Matched content -->
                    
                    
			    	<!-- content -->
			  		<h2 id="Tai-sao-ban-nen-su-dung-Docker"><a href="#Tai-sao-ban-nen-su-dung-Docker" class="headerlink" title="T&#x1EA1;i sao b&#x1EA1;n n&#xEA;n s&#x1EED; d&#x1EE5;ng Docker?"></a>T&#x1EA1;i sao b&#x1EA1;n n&#xEA;n s&#x1EED; d&#x1EE5;ng Docker?</h2><p>Khi c&#xF4;ng vi&#x1EC7;c kinh doanh c&#x1EA7;n t&#x1EDB;i nhi&#x1EC1;u &#x1EE9;ng d&#x1EE5;ng web kh&#xE1;c nhau, khi m&#xE0; b&#xE2;y gi&#x1EDD; framework hay ng&#xF4;n ng&#x1EEF; l&#x1EAD;p tr&#xEC;nh ch&#x1EC9; l&#xE0; c&#xF4;ng c&#x1EE5;. C&#xE1;c c&#xF4;ng ty kh&#xF4;ng b&#x1ECB; gi&#x1EDB;i h&#x1EA1;n v&#xE0; c&#xF3; th&#x1EC3; s&#x1EED; d&#x1EE5;ng b&#x1EA5;t k&#x1EF3; ng&#xF4;n ng&#x1EEF; n&#xE0;o c&#x1EA7;n. V&#xEC; v&#x1EAD;y ch&#xFA;ng ta c&#x1EA7;n c&#xF3; m&#x1ED9;t m&#xF4;i tr&#x1B0;&#x1EDD;ng m&#xE0; nhi&#x1EC1;u &#x1EE9;ng d&#x1EE5;ng kh&#xE1;c nhau c&#xF3; th&#x1EC3; ch&#x1EA1;y c&#xF9;ng nhau tr&#xEA;n &#x111;&#xF3;.</p><p>Virtual Machines (VM) cho ph&#xE9;p ch&#xFA;ng ta ch&#x1EA1;y nhi&#x1EC1;u app tr&#xEA;n c&#xF9;ng 1 server. Nh&#x1B0;ng c&#x169;ng c&#xF3; h&#x1EA1;n ch&#x1EBF;. M&#x1ED7;i VM c&#x1EA7;n to&#xE0;n b&#x1ED9; OS &#x111;&#x1EC3; ch&#x1EA1;y. M&#x1ED7;i OS l&#x1EA1;i c&#x1EA7;n CPU, RAM,&#x2026; &#x111;&#x1EC3; ch&#x1EA1;y, r&#x1ED3;i n&#xF3; c&#x1EA7;n patching v&#xE0; licensing, do &#x111;&#xF3; l&#xE0;m t&#x103;ng chi ph&#xED; v&#xE0; kh&#x1EA3; n&#x103;ng ph&#x1EE5;c h&#x1ED3;i.</p><p>Google b&#x1EAF;t &#x111;&#x1EA7;u s&#x1EED; d&#x1EE5;ng m&#xF4; h&#xEC;nh container t&#x1EEB; l&#xE2;u &#x111;&#x1EC3; gi&#x1EA3;i quy&#x1EBF;t c&#xE1;c thi&#x1EBF;u s&#xF3;t c&#x1EE7;a m&#xF4; h&#xEC;nh VM. V&#x1EC1; c&#x1A1; b&#x1EA3;n th&#xEC; m&#xF4; h&#xEC;nh container c&#xF3; ngh&#x129;a l&#xE0; nhi&#x1EC1;u container tr&#xEA;n c&#xF9;ng m&#x1ED9;t m&#xE1;y ch&#x1EE7; s&#x1EED; d&#x1EE5;ng c&#xF9;ng m&#x1ED9;t m&#xE1;y ch&#x1EE7;, gi&#x1EA3;i ph&#xF3;ng CPU, RAM &#x111;&#x1EC3; c&#xF3; th&#x1EC3; &#x111;&#x1B0;&#x1EE3;c s&#x1EED; d&#x1EE5;ng &#x1EDF; n&#x1A1;i kh&#xE1;c.</p><h2 id="Docker-rat-tot-vay-tai-sao-phai-toi-uu-docker-image"><a href="#Docker-rat-tot-vay-tai-sao-phai-toi-uu-docker-image" class="headerlink" title="Docker r&#x1EA5;t t&#x1ED1;t v&#x1EAD;y t&#x1EA1;i sao ph&#x1EA3;i t&#x1ED1;i &#x1B0;u docker image ?"></a>Docker r&#x1EA5;t t&#x1ED1;t v&#x1EAD;y t&#x1EA1;i sao ph&#x1EA3;i t&#x1ED1;i &#x1B0;u docker image ?</h2><p>C&#xE2;u tr&#x1EA3; l&#x1EDD;i r&#x1EA5;t &#x111;&#x1A1;n gi&#x1EA3;n: L&#xE0; &#x111;&#x1EC3; ti&#x1EBF;t ki&#x1EC7;m.<br>Ti&#x1EBF;t ki&#x1EC7;m c&#xE1;i g&#xEC;? B&#x1EA5;t c&#x1EE9; c&#xE1;i g&#xEC; g&#x1ECD;i l&#xE0; t&#xE0;i nguy&#xEA;n v&#xE0; c&#xF3; th&#x1EC3; ti&#x1EBF;t ki&#x1EC7;m &#x111;&#x1B0;&#x1EE3;c th&#xEC; ch&#xFA;ng ta s&#x1EBD; ti&#x1EBF;t ki&#x1EC7;m. V&#xED; d&#x1EE5;:</p><ul><li>Th&#x1EDD;i gian</li><li>Dung l&#x1B0;&#x1EE3;ng l&#x1B0;u tr&#x1EEF;</li><li>T&#xE0;i nguy&#xEA;n ch&#x1EA1;y (CPU, RAM)</li><li>B&#x103;ng th&#xF4;ng</li></ul><p>B&#xE2;y gi&#x1EDD; 1 image b&#x1EA1;n build ra, b&#x1EA1;n ph&#x1EA3;i m&#x1EA5;t th&#x1EDD;i gian build n&#xF3;, m&#x1EA5;t dung l&#x1B0;&#x1EE3;ng l&#x1B0;u tr&#x1EEF; &#x111;&#x1EC3; ch&#x1EE9;a n&#xF3;, t&#xE0;i nguy&#xEA;n &#x111;&#x1EC3; ch&#x1EA1;y n&#xF3;, v&#xE0; b&#x103;ng th&#xF4;ng &#x111;&#x1EC3; ph&#xE2;n ph&#x1ED1;i n&#xF3; t&#x1EDB;i c&#xE1;c m&#xE1;y ch&#x1EE7;. V&#x1EAD;y t&#x1ED1;i &#x1B0;u t&#x1EE9;c l&#xE0; ti&#x1EBF;t ki&#x1EC7;m nh&#x1EEF;ng th&#x1EE9; k&#x1EC3; tr&#xEA;n.</p><p>N&#xF3;i th&#xEC; n&#xF3;i v&#x1EAD;y, tuy nhi&#xEA;n h&#x1EA7;u h&#x1EBF;t ch&#xFA;ng ta &#x111;&#x1EC1;u ch&#x1EA3; quan t&#xE2;m &#x111;&#x1EBF;ch g&#xEC; &#x111;&#x1EBF;n m&#x1EA5;y c&#xE1;i th&#x1EE9; &#x111;&#xF3;, v&#xEC; n&#xF3; kh&#xF4;ng th&#x1EF1;c t&#x1EBF; v&#xE0; g&#x1EA7;n g&#x169;i v&#x1EDB;i nh&#x1EEF;ng th&#x1EE9; ch&#xFA;ng ta l&#xE0;m h&#xE0;ng ng&#xE0;y. Nh&#x1B0;ng n&#x1EBF;u b&#x1EA1;n &#x1EDF; v&#xE0;o ho&#xE0;n c&#x1EA3;nh ph&#x1EA3;i ch&#x1EDD; &#x111;&#x1EE3;i m&#xF2;n m&#x1ECF;i 10 ph&#xFA;t &#x111;&#x1EC3; &#x111;&#x1EA9;y hotfix l&#xEA;n server, b&#x1EA1;n s&#x1EBD; bi&#x1EBF;t qu&#xFD; tr&#x1ECD;ng th&#x1EDD;i gian, hay qu&#x1EA3;n l&#xFD; m&#x1ED9;t h&#x1EC7; th&#x1ED1;ng kho&#x1EA3;ng 50 container &#x111;ang ch&#x1EA1;y, th&#xEC; s&#x1ED1; ti&#x1EC1;n b&#x1EA1;n b&#x1ECF; ra cho vi&#x1EC7;c phung ph&#xED; t&#xE0;i nguy&#xEA;n l&#xE0; s&#x1EBD; kh&#xF4;ng nh&#x1ECF;.</p><h2 id="Hien-trang"><a href="#Hien-trang" class="headerlink" title="Hi&#x1EC7;n tr&#x1EA1;ng"></a>Hi&#x1EC7;n tr&#x1EA1;ng</h2><p>H&#xE3;y b&#x1EAF;t &#x111;&#x1EA7;u v&#x1EDB;i v&#x1EDB;i hi&#x1EC7;n tr&#x1EA1;ng c&#x1EE7;a m&#xEC;nh tr&#x1B0;&#x1EDB;c &#x111;&#xE2;y b&#x1EB1;ng 1 Dockerfile ch&#x1EA1;y <strong>NodeJS</strong> &#x111;&#x1A1;n gi&#x1EA3;n.</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker image ls -a | grep app</span><br><span class="line">app   lattest         c9bbbeb45eca        13 minutes ago      1.25GB</span><br></pre></td></tr></tbody></table></figure><p>Image n&#xE0;y build m&#x1EA5;t 4 ph&#xFA;t v&#xE0; n&#x1EB7;ng t&#x1EDB;i 1.25GB. Th&#x1EAD;t kh&#xF4;ng th&#x1EC3; tin &#x111;&#x1B0;&#x1EE3;c. C&#xF3; g&#xEC; &#x111;&#xF3; sai sai &#x1EDF; &#x111;&#xE2;y r&#x1ED3;i, &#x1EE9;ng d&#x1EE5;ng c&#x1EE7;a m&#xEC;nh ch&#x1EC9; l&#xE0; m&#x1ED9;t &#x1EE9;ng d&#x1EE5;ng API ch&#x1EA1;y b&#x1EB1;ng expressjs h&#x1EBF;t s&#x1EE9;c nh&#x1EB9; m&#xE0;.</p><p>Ch&#x1B0;a h&#x1EBF;t, m&#xEC;nh th&#x1EED; thay &#x111;&#x1ED5;i 1 file README.md trong project, sau &#x111;&#xF3; th&#x1EED; build l&#x1EA1;i th&#xEC; v&#x1EAB;n m&#x1EA5;t 3 ph&#xFA;t (do kh&#xF4;ng ph&#x1EA3;i download l&#x1EA1;i base image). Image c&#x1EE7;a m&#xEC;nh &#x111;&#x1B0;&#x1EE3;c build l&#x1EA1;i to&#xE0;n b&#x1ED9;, b&#x1EAF;t ngu&#x1ED3;n t&#x1EEB; d&#xF2;ng ADD . /app, bao g&#x1ED3;m c&#x1EA3; vi&#x1EC7;c install dependencies, build app,&#x2026; Trong khi README.md th&#xEC; li&#xEA;n quan g&#xEC; t&#x1EDB;i &#x1EE9;ng d&#x1EE5;ng c&#x1EE7;a m&#xEC;nh &#x111;&#xE2;u &#x111;&#x1EC3; ph&#x1EA3;i m&#x1EA5;t bao nhi&#xEA;u th&#x1EDD;i gian v&#xE0; t&#xE0;i nguy&#xEA;n build l&#x1EA1;i image nh&#x1B0; th&#x1EBF;?</p><p>H&#x1EC7; th&#x1ED1;ng c&#x1EE7;a m&#xEC;nh c&#xF2;n ch&#x1EA1;y CI/CD n&#xEA;n v&#x1EDB;i vi&#x1EC7;c setup Dockerfile ph&#xED;a tr&#xEA;n, m&#x1ED7;i l&#x1EA7;n ch&#x1EA1;y m&#xEC;nh m&#x1EA5;t 15 ph&#xFA;t &#x111;&#x1EC3; code c&#xF3; th&#x1EC3; ch&#x1EA1;y &#x111;&#x1B0;&#x1EE3;c tr&#xEA;n server. WTF?</p><h2 id="Ket-qua"><a href="#Ket-qua" class="headerlink" title="K&#x1EBF;t qu&#x1EA3;"></a>K&#x1EBF;t qu&#x1EA3;</h2><p>Sau 1 h&#x1ED3;i t&#xEC;m t&#xF2;i h&#x1ECD;c h&#x1ECF;i v&#xE0; t&#x1ED1;i &#x1B0;u, gi&#x1EDD; &#x111;&#xE2;y image app c&#x1EE7;a m&#xEC;nh ch&#x1EC9; n&#x1EB7;ng v&#x1ECF;n v&#x1EB9;n 150MB thay v&#xEC; 1.25GB nh&#x1B0; tr&#x1B0;&#x1EDB;c, m&#x1EA5;t 1p30s &#x111;&#x1EC3; build l&#x1EA7;n &#x111;&#x1EA7;u ti&#xEA;n, v&#xE0; ch&#x1EC9; 10s &#x111;&#x1EC3; build m&#x1ED7;i khi m&#xEC;nh thay &#x111;&#x1ED5;i code ch&#xFA;t &#xED;t. Qu&#xE1; tr&#xEC;nh CI/CD c&#x169;ng t&#x1EEB; &#x111;&#xF3; r&#xFA;t ng&#x1EAF;n xu&#x1ED1;ng 8 ph&#xFA;tcho l&#x1EA7;n &#x111;&#x1EA7;u ti&#xEA;n v&#xE0; ch&#x1EC9; 3 ph&#xFA;t cho c&#xE1;c thay &#x111;&#x1ED5;i code sau n&#xE0;y thay v&#xEC; c&#x1EE9; &#x111;&#x1EC1;u nh&#x1B0; v&#x1EAF;t chanh 15 ph&#xFA;t 1 l&#x1EA7;n nh&#x1B0; tr&#x1B0;&#x1EDB;c.<br>V&#x1EAD;y m&#xEC;nh &#x111;&#xE3; l&#xE0;m g&#xEC;?</p><h2 id="Toi-uu-the-nao"><a href="#Toi-uu-the-nao" class="headerlink" title="T&#x1ED1;i &#x1B0;u th&#x1EBF; n&#xE0;o?"></a>T&#x1ED1;i &#x1B0;u th&#x1EBF; n&#xE0;o?</h2><p>Gi&#x1EDD; khi &#x111;&#xE3; hi&#x1EC3;u t&#x1EA1;i sao ph&#x1EA3;i t&#x1ED1;i &#x1B0;u, ta b&#x1B0;&#x1EDB;c &#x111;&#x1EBF;n b&#x1B0;&#x1EDB;c kh&#xF3; kh&#x103;n h&#x1A1;n l&#xE0; t&#x1ED1;i &#x1B0;u th&#x1EBF; n&#xE0;o. &#x110;&#xE2;y l&#xE0; m&#x1ED9;t s&#x1ED1; b&#x1B0;&#x1EDB;c ch&#xED;nh m&#xEC;nh &#x111;&#xE3; l&#xE0;m &#x111;&#x1EC3; c&#xF3; th&#x1EC3; t&#x1ED1;i &#x1B0;u &#x111;&#x1B0;&#x1EE3;c qu&#xE1; tr&#xEC;nh build n&#xE0;y. Ngo&#xE0;i ra c&#xF2;n 1 v&#xE0;i c&#xE1;i l&#x1EB7;t v&#x1EB7;t n&#x1EEF;a nh&#x1B0; remove file t&#x1EA1;m,&#x2026; th&#xEC; t&#x1EA1;m kh&#xF4;ng nh&#x1EAF;c t&#x1EDB;i.</p><h2 id="Thay-doi-base-image"><a href="#Thay-doi-base-image" class="headerlink" title="Thay &#x111;&#x1ED5;i base image"></a>Thay &#x111;&#x1ED5;i base image</h2><p>&#x110;&#xE2;y l&#xE0; b&#x1B0;&#x1EDB;c &#x111;&#x1EA7;u ti&#xEA;n v&#xE0; quan tr&#x1ECD;ng nh&#x1EA5;t, tr&#x1EEB; khi ho&#xE0;n c&#x1EA3;nh kh&#xF4;ng cho ph&#xE9;p ho&#x1EB7;c image kh&#xF4;ng c&#xF3; s&#x1EB5;n, n&#x1EBF;u kh&#xF4;ng h&#xE3;y lu&#xF4;n s&#x1EED; d&#x1EE5;ng image &#x111;&#x1B0;&#x1EE3;c d&#x1EF1;ng tr&#xEA;n alpine. &#x110;&#xE2;y l&#xE0; nh&#x1EEF;ng base image nh&#x1EB9; nh&#x1EA5;t, t&#x1ED1;i &#x1B0;u nh&#x1EA5;t cho vi&#x1EC7;c l&#x1B0;u tr&#x1EEF; m&#xE0; v&#x1EAB;n &#x111;&#x1EE7; &#x111;i&#x1EC1;u ki&#x1EC7;n &#x111;&#x1EC3; app c&#x1EE7;a ch&#xFA;ng ta ch&#x1EA1;y ngon l&#xE0;nh.</p><p>Thay v&#xEC; s&#x1EED; d&#x1EE5;ng FROM node:10, m&#xEC;nh &#x111;&#xE3; chuy&#x1EC3;n qua s&#x1EED; d&#x1EE5;ng FROM node:10-alpine</p><p>C&#xE1;c image d&#x1EF1;ng tr&#xEA;n alpine c&#xF3; dung l&#x1B0;&#x1EE3;ng r&#x1EA5;t nh&#x1EB9;, v&#x1EDB;i nodejs l&#xE0; gi&#x1EA3;m t&#x1EEB; 900MB c&#x1EE7;a b&#x1EA3;n m&#x1EB7;c &#x111;&#x1ECB;nh xu&#x1ED1;ng ch&#x1EC9; c&#xF2;n 70MB c&#x1EE7;a alpine.</p><p>&#x110;i&#x1EC3;m tr&#x1EEB; duy nh&#x1EA5;t c&#x1EE7;a alpine &#x111;&#xF3; l&#xE0; vi&#x1EC7;c n&#xF3; qu&#xE1; nh&#x1ECF; g&#x1ECD;n n&#xEA;n b&#x1EA1;n ph&#x1EA3;i t&#x1EF1; t&#xFA;c c&#xE0;i th&#xEA;m nh&#x1EEF;ng th&#x1B0; vi&#x1EC7;n b&#x1EA1;n c&#x1EA7;n d&#xF9;ng. V&#xE0; vi&#x1EC7;c n&#xE0;y v&#x1EDB;i nh&#x1EEF;ng ng&#x1B0;&#x1EDD;i m&#x1EDB;i l&#xE0; kh&#xE1; r&#x1EAF;c r&#x1ED1;i &#x111;&#xF3; nh&#xE9;.</p><h2 id="Tan-dung-layer-caching"><a href="#Tan-dung-layer-caching" class="headerlink" title="T&#x1EAD;n d&#x1EE5;ng layer caching"></a>T&#x1EAD;n d&#x1EE5;ng layer caching</h2><p>Layer caching l&#xE0; m&#x1ED9;t t&#xED;nh n&#x103;ng r&#x1EA5;t quan tr&#x1ECD;ng gi&#xFA;p gi&#x1EA3;m th&#x1EDD;i gian c&#x1EE7;a qu&#xE1; tr&#xEC;nh build b&#x1EB1;ng c&#xE1;ch t&#x1EAD;n d&#x1EE5;ng nh&#x1EEF;ng layer &#x111;&#xE3; &#x111;&#x1B0;&#x1EE3;c build t&#x1EEB; l&#x1EA7;n tr&#x1B0;&#x1EDB;c &#x111;&#xF3; (v&#x1EDB;i &#x111;i&#x1EC1;u ki&#x1EC7;n kh&#xF4;ng c&#xF3; thay &#x111;&#x1ED5;i trong ch&#x1EC9; &#x111;&#x1ECB;nh build). &#x110;&#x1EC3; c&#xF3; th&#x1EC3; t&#x1EAD;n d&#x1EE5;ng t&#x1ED1;i &#x111;a t&#xED;nh n&#x103;ng n&#xE0;y, ta c&#x1EA7;n s&#x1EAF;p x&#x1EBF;p l&#x1EA1;i v&#xE0; t&#xE1;ch l&#x1EC7;nh build sao cho ph&#x1EA7;n l&#x1EC7;nh &#xED;t thay &#x111;&#x1ED5;i s&#x1EBD; &#x1EDF; tr&#xEA;n, ph&#x1EA7;n thay &#x111;&#x1ED5;i th&#x1B0;&#x1EDD;ng xuy&#xEA;n s&#x1EBD; &#x1EDF; d&#x1B0;&#x1EDB;i.</p><p>&#x110;&#xE2;y l&#xE0; &#x111;i&#x1EC1;u m&#xEC;nh &#x111;&#xE3; l&#xE0;m v&#x1EDB;i Dockerfile tr&#xEA;n:</p><p>M&#xEC;nh &#x111;&#xE3; chuy&#x1EC3;n EXPOSE 3000 l&#xEA;n tr&#xEA;n c&#xF9;ng v&#x1EDB;i WORKDIR /app, t&#xE1;ch ph&#x1EA7;n ADD . /app ra &#x111;&#x1EC3; th&#xEA;m 1 ch&#x1EC9; &#x111;&#x1ECB;nh ADD package.json yarn.lock /app/. Do 2 file package.json v&#xE0; yarn.lock ch&#x1EE9;a th&#xF4;ng tin v&#x1EC1; nh&#x1EEF;ng package m&#xEC;nh d&#xF9;ng nh&#x1B0;ng l&#x1EA1;i &#xED;t thay &#x111;&#x1ED5;i, do &#x111;&#xF3; &#x111;&#x1EA9;y n&#xF3; l&#xEA;n tr&#xEA;n s&#x1EBD; gi&#xFA;p vi&#x1EC7;c c&#xE0;i &#x111;&#x1EB7;t dependencies t&#x1EEB; npm c&#xF3; th&#x1EC3; s&#x1EED; d&#x1EE5;ng l&#x1EA1;i t&#x1EEB; image &#x111;&#xE3; build t&#x1EEB; tr&#x1B0;&#x1EDB;c.</p><p><strong>Tips: S&#x1EAF;p x&#x1EBF;p c&#xE1;c l&#x1EC7;nh build theo s&#x1EF1; thay &#x111;&#x1ED5;i th&#x1B0;&#x1EDD;ng xuy&#xEA;n t&#x103;ng d&#x1EA7;n</strong></p><h2 id="Giam-bot-so-luong-layer"><a href="#Giam-bot-so-luong-layer" class="headerlink" title="Gi&#x1EA3;m b&#x1EDB;t s&#x1ED1; l&#x1B0;&#x1EE3;ng layer"></a>Gi&#x1EA3;m b&#x1EDB;t s&#x1ED1; l&#x1B0;&#x1EE3;ng layer</h2><p>Nh&#x1B0; ch&#xFA;ng ta &#x111;&#x1EC1;u &#x111;&#xE3; bi&#x1EBF;t, docker image &#x111;&#x1B0;&#x1EE3;c d&#x1EF1;ng n&#xEA;n t&#x1EEB; nh&#x1EEF;ng layer x&#x1EBF;p ch&#x1ED3;ng l&#xEA;n nhau, m&#x1ED7;i layer &#x111;&#x1B0;&#x1EE3;c t&#x1EA1;o ra t&#x1EEB; c&#xE1;c c&#xE2;u l&#x1EC7;nh ch&#xFA;ng ta vi&#x1EBF;t trong Dockerfile. C&#xE0;ng nhi&#x1EC1;u layer th&#xEC; image c&#x1EE7;a ch&#xFA;ng ta c&#xE0;ng n&#x1EB7;ng n&#x1EC1;. Ch&#xED;nh v&#xEC; v&#x1EAD;y vi&#x1EC7;c gi&#x1EA3;m thi&#x1EC3;u t&#x1ED1;i &#x111;a s&#x1ED1; l&#x1B0;&#x1EE3;ng layer ch&#xED;nh l&#xE0; c&#xE1;ch &#x111;&#x1EC3; t&#x1ED1;i &#x1B0;u dung l&#x1B0;&#x1EE3;ng image.</p><p>C&#xF3; 3 c&#xE2;u l&#x1EC7;nh s&#x1EBD; t&#x1EA1;o ra c&#xE1;c layer m&#x1EDB;i l&#xE0; RUN, COPY v&#xE0; ADD, n&#xEA;n vi&#x1EC7;c g&#x1ED9;p l&#x1EC7;nh n&#xE0;y ch&#x1EC9; c&#xF3; t&#xE1;c d&#x1EE5;ng v&#x1EDB;i 3 l&#x1EC7;nh n&#xE0;y nh&#xE9;. Trong v&#xED; d&#x1EE5; tr&#xEA;n, m&#xEC;nh &#x111;&#xE3; g&#x1ED9;p nh&#x1EEF;ng c&#xE2;u l&#x1EC7;nh sau th&#xE0;nh 1 l&#x1EC7;nh, do &#x111;&#xF3; ch&#x1EC9; t&#x1EA1;o ra 1 layer duy nh&#x1EA5;t:</p><p>M&#x1ED9;t l&#x1B0;u &#xFD; khi c&#xE1;c b&#x1EA1;n &#x1EE9;ng d&#x1EE5;ng bi&#x1EC7;n ph&#xE1;p n&#xE0;y, &#x111;&#xF3; ch&#xED;nh l&#xE0; vi&#x1EC7;c g&#x1ED9;p l&#x1EA1;i th&#xE0;nh 1 d&#xF2;ng s&#x1EBD; l&#xE0;m m&#x1EA5;t &#x111;i &#x1B0;u th&#x1EBF; c&#x1EE7;a caching layer khi build. B&#x1EA1;n &#x111;&#xE2;u mu&#x1ED1;n ch&#x1EC9; v&#xEC; m&#x1ED9;t thay &#x111;&#x1ED5;i nh&#x1ECF; m&#xE0; d&#x1EAB;n t&#x1EDB;i image b&#x1ECB; build l&#x1EA1;i t&#x1EEB; nh&#x1EEF;ng b&#x1B0;&#x1EDB;c &#x111;&#x1EA7;u ch&#x1EA3; li&#xEA;n quan &#x111;&#xFA;ng kh&#xF4;ng? Do v&#x1EAD;y tr&#x1B0;&#x1EDB;c ghi g&#x1ED9;p, h&#xE3;y t&#xED;nh t&#x1EDB;i nh&#x1EEF;ng thay &#x111;&#x1ED5;i b&#x1EA1;n c&#xF3; th&#x1EC3; t&#x1EA1;o ra cho &#x1EE9;ng d&#x1EE5;ng, v&#xE0; t&#x1ED1;i &#x1B0;u vi&#x1EC7;c caching layer c&#x1EA7;n &#x111;&#x1B0;&#x1EE3;c &#x1B0;u ti&#xEA;n h&#x1A1;n.</p><h2 id="Toi-uu-dockerignore"><a href="#Toi-uu-dockerignore" class="headerlink" title="T&#x1ED1;i &#x1B0;u .dockerignore"></a>T&#x1ED1;i &#x1B0;u .dockerignore</h2><p>Nh&#x1B0; m&#xEC;nh &#x111;&#xE3; n&#xF3;i trong 1 s&#x1ED1; b&#xE0;i vi&#x1EBF;t kh&#xE1;c, file .dockerignore sinh ra v&#x1EDB;i m&#x1EE5;c &#x111;&#xED;ch b&#xE1;o cho docker bi&#x1EBF;t &#x111;&#x1EC3; lo&#x1EA1;i tr&#x1EEB; nh&#x1EEF;ng file n&#xE0;y ra kh&#x1ECF;i build context, t&#x1EE9;c l&#xE0; lo&#x1EA1;i ra kh&#x1ECF;i nh&#x1EEF;ng file m&#xE0; docker &#x111;&#x1ECB;nh d&#xF9;ng &#x111;&#x1EC3; build image.</p><p>&#x110;&#x1EC3; tr&#xE1;nh vi&#x1EC7;c b&#x1EA1;n s&#x1EED;a 1 file README.md ch&#x1EA3; li&#xEA;n quan m&#xE0; c&#x169;ng khi&#x1EBF;n image c&#x1EE7;a b&#x1EA1;n ph&#x1EA3;i build l&#x1EA1;i, h&#xE3;y th&#xEA;m n&#xF3; v&#xE0;o .dockerignore. Sau &#x111;&#xE2;y l&#xE0; 1 s&#x1ED1; lo&#x1EA1;i file n&#xEA;n &#x111;&#x1B0;a v&#xE0;o .dockerignore</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Environment variables</span></span><br><span class="line">.env</span><br><span class="line"></span><br><span class="line"><span class="comment"># Logs</span></span><br><span class="line">logs</span><br><span class="line">*.<span class="built_in">log</span></span><br><span class="line">npm-debug.log*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Documentation</span></span><br><span class="line">docs</span><br><span class="line">*.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># Coverage directory used by tools like istanbul</span></span><br><span class="line">coverage</span><br><span class="line"></span><br><span class="line"><span class="comment"># nyc test coverage</span></span><br><span class="line">.nyc_output</span><br><span class="line"></span><br><span class="line"><span class="comment"># Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)</span></span><br><span class="line">.grunt</span><br><span class="line"></span><br><span class="line"><span class="comment"># node-waf configuration</span></span><br><span class="line">.lock-wscript</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dependency directories</span></span><br><span class="line">node_modules</span><br><span class="line">jspm_packages</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional npm cache directory</span></span><br><span class="line">.npm</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional REPL history</span></span><br><span class="line">.node_repl_history</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dist folder (code after build)</span></span><br><span class="line">dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># Project file</span></span><br><span class="line">*.sublime-project</span><br><span class="line">*.sublime-workspace</span><br><span class="line"></span><br><span class="line"><span class="comment"># Git file</span></span><br><span class="line">.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker file</span></span><br><span class="line">*Dockerfile*</span><br><span class="line">*docker-compose*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Deploy folder and file</span></span><br><span class="line">deploy</span><br><span class="line">.gitlab-ci.yml</span><br></pre></td></tr></tbody></table></figure><h2 id="Su-dung-multi-stage-build"><a href="#Su-dung-multi-stage-build" class="headerlink" title="S&#x1EED; d&#x1EE5;ng multi-stage build"></a>S&#x1EED; d&#x1EE5;ng multi-stage build</h2><p>&#x110;&#xE2;y l&#xE0; ph&#x1B0;&#x1A1;ng ph&#xE1;p cu&#x1ED1;i c&#xF9;ng m&#xEC;nh &#x111;&#x1EC1; c&#x1EAD;p trong b&#xE0;i vi&#x1EBF;t n&#xE0;y. Multi-stage build &#x111;&#x1B0;&#x1EE3;c gi&#x1EDB;i thi&#x1EC7;u t&#x1EEB; docker v17.05, l&#xE0; m&#x1ED9;t c&#xE1;ch r&#x1EA5;t m&#x1EDB;i &#x111;&#x1EC3; c&#xE1;c b&#x1EA1;n t&#x1ED1;i &#x1B0;u &#x111;&#x1B0;&#x1EE3;c runtime image c&#x1EE7;a m&#xEC;nh b&#x1EB1;ng vi&#x1EC7;c lo&#x1EA1;i b&#x1ECF; &#x111;i to&#xE0;n b&#x1ED9; nh&#x1EEF;ng th&#x1EE9; &#x111;&#x1B0;&#x1EE3;c sinh ra trong qu&#xE1; tr&#xEC;nh install, build code,&#x2026; nh&#x1B0;ng l&#x1EA1;i kh&#xF4;ng c&#x1EA7;n thi&#x1EBF;t cho qu&#xE1; tr&#xEC;nh ch&#x1EA1;y &#x1EE9;ng d&#x1EE5;ng. Tr&#x1EDF; l&#x1EA1;i v&#x1EDB;i v&#xED; d&#x1EE5; trong b&#xE0;i, m&#xEC;nh s&#x1EBD; t&#xE1;ch image c&#x169; th&#xE0;nh 2 image tr&#xEA;n m&#x1ED9;t Dockerfile nh&#x1B0; sau:</p><p>V&#x1EDB;i vi&#x1EC7;c t&#xE1;ch image nh&#x1B0; th&#x1EBF; n&#xE0;y. Image runtime c&#x1EE7;a m&#xEC;nh ch&#x1EC9; n&#x1EB7;ng 160MB m&#xE0; kh&#xF4;ng ph&#x1EA3;i l&#xE0; 400MB nh&#x1B0; vi&#x1EC7;c ch&#x1EC9; s&#x1EED; d&#x1EE5;ng 1 image.</p><p>Tuy nhi&#xEA;n c&#xE1;i l&#x1EE3;i n&#xE0;o c&#x169;ng &#x111;i c&#xF9;ng c&#xE1;i gi&#xE1; c&#x1EE7;a n&#xF3;. Ch&#xFA;ng ta c&#xF3; th&#x1EC3; gi&#x1EA3;m &#x111;&#x1B0;&#x1EE3;c dung l&#x1B0;&#x1EE3;ng runtime image, nh&#x1B0;ng l&#x1EA1;i m&#x1EA5;t &#x111;i 1 t&#xED;nh n&#x103;ng h&#x1EBF;t s&#x1EE9;c quan tr&#x1ECD;ng l&#xE0; layer caching. Vi&#x1EC7;c docker ch&#x1EC9; l&#x1B0;u l&#x1EA1;i image k&#x1EBF;t qu&#x1EA3; cu&#x1ED1;i c&#xF9;ng m&#xE0; kh&#xF4;ng l&#x1B0;u builder image l&#xE0;m to&#xE0;n b&#x1ED9; c&#xF4;ng t&#xE1;ch r&#x1ED3;i gh&#xE9;p l&#x1EC7;nh c&#x1EE7;a ch&#xFA;ng ta &#x111;&#x1ED5; s&#xF4;ng &#x111;&#x1ED5; b&#x1EC3;.</p><p>Nh&#x1B0;ng c&#xE1;c b&#x1EA1;n &#x111;&#x1EEB;ng v&#x1ED9;i b&#x1EA3;o m&#xEC;nh t&#x1EA1;i sao l&#x1EA1;i x&#xFA;i b&#x1EA1;n t&#xE1;ch gh&#xE9;p l&#x1EC7;nh l&#xE0;m g&#xEC;. Vi&#x1EC7;c g&#xEC; kh&#xF3; c&#x169;ng c&#xF3; c&#xE1;ch gi&#x1EA3;i quy&#x1EBF;t, ch&#x1EC9; l&#xE0; n&#xF3; h&#x1A1;i m&#x1EA5;t c&#xF4;ng 1 ch&#xFA;t. Ch&#xFA;ng ta ho&#xE0;n to&#xE0;n c&#xF3; th&#x1EC3; l&#x1B0;u l&#x1EA1;i &#x111;&#x1B0;&#x1EE3;c builder image v&#xE0; d&#xF9;ng n&#xF3; l&#xE0;m cache cho l&#x1EA7;n build sau b&#x1EB1;ng 1 l&#x1EC7;nh build k&#xE8;m &#x2013;target nh&#x1B0; sau:</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t app:builder --target=builder .</span><br></pre></td></tr></tbody></table></figure><p>Ch&#x1EC9; &#x111;&#x1ECB;nh &#x2013;target s&#x1EBD; gi&#xFA;p qu&#xE1; tr&#xEC;nh build d&#x1EEB;ng l&#x1EA1;i &#x1EDF; b&#x1B0;&#x1EDB;c builder, t&#x1EEB; &#x111;&#xF3; ch&#xFA;ng ta s&#x1EBD; c&#xF3; 1 image builder ngon ngh&#x1EBB; &#x111;&#x1EC3; cache cho l&#x1EA7;n sau r&#x1ED3;i.</p><p>Tips: Multi stage build gi&#xFA;p ti&#x1EBF;t ki&#x1EC7;m t&#xE0;i nguy&#xEA;n cho qu&#xE1; tr&#xEC;nh runtime, nh&#x1B0;ng l&#x1EA1;i t&#x1ED1;n th&#xEA;m t&#xE0;i nguy&#xEA;n l&#x1B0;u tr&#x1EEF; th&#x1EDD;i gian trong qu&#xE1; tr&#xEC;nh build. Tuy nhi&#xEA;n t&#x1EEB; kinh nghi&#x1EC7;m c&#xE1; nh&#xE2;n c&#x1EE7;a m&#xEC;nh th&#xEC; vi&#x1EC7;c n&#xE0;y ho&#xE0;n to&#xE0;n x&#x1EE9;ng &#x111;&#xE1;ng &#x111;&#xE1;nh &#x111;&#x1ED5;i.</p><h2 id="Ngoai-le-ve-cach-quan-ly-microservice-image"><a href="#Ngoai-le-ve-cach-quan-ly-microservice-image" class="headerlink" title="Ngo&#xE0;i l&#x1EC1; v&#x1EC1; c&#xE1;ch qu&#x1EA3;n l&#xFD; microservice image"></a>Ngo&#xE0;i l&#x1EC1; v&#x1EC1; c&#xE1;ch qu&#x1EA3;n l&#xFD; microservice image</h2><p>&#x110;&#x1EBF;n &#x111;&#xE2;y coi nh&#x1B0; m&#xEC;nh &#x111;&#xE3; n&#xF3;i xong v&#x1EDB;i c&#xE1;c b&#x1EA1;n v&#x1EC1; c&#xE1;ch t&#x1ED1;i &#x1B0;u docker image trong prodcution ph&#x1EE5;c v&#x1EE5; c&#x1EA3; qu&#xE1; tr&#xEC;nh build v&#xE0; runtime. Ti&#x1EC7;n th&#x1EC3; m&#xEC;nh s&#x1EBD; chia s&#x1EBB; lu&#xF4;n v&#x1EC1; c&#xE1;ch m&#xEC;nh qu&#x1EA3;n l&#xFD; m&#x1EA5;y ch&#x1EE5;c image hi&#x1EC7;n t&#x1EA1;i c&#x1EE7;a s&#x1EA3;n ph&#x1EA9;m.</p><p>C&#xE1;c b&#x1EA1;n n&#x1EBF;u &#x111;&#xE3; l&#xE0;m microservice, nh&#x1EA5;t l&#xE0; v&#x1EDB;i s&#x1ED1; l&#x1B0;&#x1EE3;ng l&#x1EDB;n &#x111;&#x1EC1;u s&#x1EBD; nh&#x1EAD;n th&#x1EA5;y m&#x1ED9;t v&#x1EA5;n &#x111;&#x1EC1; &#x111;&#xF3; ch&#xED;nh l&#xE0; vi&#x1EC7;c qu&#x1EA3;n l&#xFD; image c&#x1EE7;a to&#xE0;n b&#x1ED9; c&#xE1;c microservice l&#xE0; r&#x1EA5;t m&#x1EA5;t th&#x1EDD;i gian v&#xE0; v&#x1EA5;t v&#x1EA3;. V&#x1EDB;i kho&#x1EA3;ng 20 microservice, trong &#x111;&#xF3; c&#xF3; 17 service backend v&#xE0; 3 service frontend th&#xEC; s&#x1ED1; l&#x1B0;&#x1EE3;ng image na n&#xE1; nhau l&#xE0; r&#x1EA5;t nhi&#x1EC1;u.</p><p>Gi&#x1EA3; s&#x1EED; b&#x1EA1;n mu&#x1ED1;n th&#xEA;m v&#xE0;o to&#xE0;n b&#x1ED9; c&#xE1;c image backend m&#x1ED9;t file ch&#x1EE9;a th&#x1EDD;i gian image &#x111;&#xF3; &#x111;&#x1B0;&#x1EE3;c build ch&#x1EB3;ng h&#x1EA1;n. Khi &#x111;&#xF3; b&#x1EA1;n s&#x1EBD; ph&#x1EA3;i s&#x1EED;a l&#x1EA1;i 17 project backend ch&#x1EC9; &#x111;&#x1EC3; copy paste l&#x1EA1;i &#x111;&#xFA;ng 1 d&#xF2;ng. Nghe n&#x1EA3;n kh&#xF4;ng?</p><p>R&#x1EA5;t may l&#xE0; docker c&#xF3; gi&#x1EDB;i thi&#x1EC7;u m&#x1ED9;t ch&#x1EC9; th&#x1ECB; c&#xF3; t&#xEA;n l&#xE0; ONBUILD. Doc c&#x1EE7;a n&#xF3; <a href="https://docs.docker.com/engine/reference/builder/#onbuild" target="_blank" rel="noopener external nofollow noreferrer">t&#x1EA1;i &#x111;&#xE2;y</a>. V&#x1EAD;y ONBUILD c&#xF3; t&#xE1;c d&#x1EE5;ng g&#xEC; trong tr&#x1B0;&#x1EDD;ng h&#x1EE3;p n&#xE0;y?</p><p>ONBUILD l&#xE0; ch&#x1EC9; th&#x1ECB; t&#x1EA1;o ra 1 trigger, n&#xF4;m na l&#xE0; 1 &#x111;i&#x1EC3;m ch&#x1EDD;. Khi m&#xEC;nh build image X c&#xF3; ch&#x1EE9;a ch&#x1EC9; th&#x1ECB; ONBUILD th&#xEC; l&#x1EC7;nh ph&#xED;a sau ONBUILD s&#x1EBD; kh&#xF4;ng &#x111;&#x1B0;&#x1EE3;c th&#x1EF1;c thi m&#xE0; s&#x1EBD; ch&#x1EDD; &#x111;&#x1EE3;i. Cho &#x111;&#x1EBF;n khi image X &#x111;&#x1B0;&#x1EE3;c d&#xF9;ng l&#xE0;m base image cho 1 image kh&#xE1;c th&#xEC; l&#x1EC7;nh sau ONBUILD m&#x1EDB;i &#x111;&#x1B0;&#x1EE3;c th&#x1EF1;c thi.</p><p>V&#xED; d&#x1EE5;:</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t <span class="built_in">test</span> .</span><br><span class="line">Sending build context to Docker daemon  2.048kB</span><br><span class="line">Step 1/3 : FROM node:10-alpine</span><br><span class="line"> ---&gt; df48b68da02a</span><br><span class="line">Step 2/3 : ONBUILD ADD package.json yarn.lock /app/</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 91fb4e71156f</span><br><span class="line">Removing intermediate container 91fb4e71156f</span><br><span class="line"> ---&gt; efb9bf8fe2a9</span><br><span class="line">Step 3/3 : ONBUILD RUN yarn --pure-lockfile</span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 22441a427546</span><br><span class="line">Removing intermediate container 22441a427546</span><br><span class="line"> ---&gt; 9a57cb7773e0</span><br><span class="line">Successfully built 9a57cb7773e0</span><br><span class="line">Successfully tagged <span class="built_in">test</span>:latest</span><br></pre></td></tr></tbody></table></figure><p>Nh&#x1B0; c&#xE1;c b&#x1EA1;n th&#x1EA5;y, trong image test m&#xEC;nh v&#x1EEB;a build kh&#xF4;ng h&#x1EC1; c&#xF3; file package.json hay yarn.lock n&#xE0;o c&#x1EA3;, ch&#x1EC9; l&#xE0; m&#x1ED9;t l&#x1EC7;nh ch&#x1EDD; &#x111;&#x1EE3;i &#x111;&#x1B0;&#x1EE3;c t&#x1EA1;o ra m&#xE0; th&#xF4;i.<br>Gi&#x1EDD; trong project code c&#x1EE7;a m&#xEC;nh th&#xEC; Dockerfile m&#xEC;nh s&#x1EBD; vi&#x1EBF;t:</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM <span class="built_in">test</span></span><br></pre></td></tr></tbody></table></figure><p>V&#xE0; &#x111;&#xE2;y l&#xE0; k&#x1EBF;t qu&#x1EA3; khi build</p><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t app .</span><br><span class="line">Sending build context to Docker daemon  513.5kB</span><br><span class="line">Step 1/1 : FROM builder</span><br><span class="line"><span class="comment"># Executing 2 build triggers</span></span><br><span class="line"> ---&gt; Running <span class="keyword">in</span> 775275b026e1</span><br><span class="line">yarn install v1.9.4</span><br><span class="line">Done <span class="keyword">in</span> 29.47s.</span><br><span class="line">Removing intermediate container 775275b026e1</span><br><span class="line"> ---&gt; 1903e4902d84</span><br><span class="line">Successfully built 1903e4902d84</span><br><span class="line">Successfully tagged app:latest</span><br></pre></td></tr></tbody></table></figure><p>V&#xE0; cho t&#x1EDB;i l&#xFA;c n&#xE0;y, 2 l&#x1EC7;nh m&#xE0; m&#xEC;nh c&#x1EA7;n l&#xE0; ADD package.json yarn.lock /app/ v&#xE0; RUN yarn &#x2013;pure-lockfile m&#x1EDB;i th&#x1EAD;t s&#x1EF1; &#x111;&#x1B0;&#x1EE3;c th&#x1EF1;c thi. V&#x1EAD;y l&#xE0; trong project c&#x1EE7;a m&#xEC;nh kh&#xF4;ng c&#x1EA7;n ph&#x1EA3;i &#x111;&#x1ECB;nh ngh&#x129;a l&#x1EA1;i Dockerfile n&#x1EEF;a, ch&#x1EC9; vi&#x1EC7;c s&#x1EED; d&#x1EE5;ng 1 template do m&#xEC;nh t&#x1EA1;o ra cho to&#xE0;n b&#x1ED9; c&#xE1;c service l&#xE0; &#x111;&#x1B0;&#x1EE3;c.</p><p>&#x110;i&#x1EC1;u n&#xE0;y gi&#xFA;p ti&#x1EBF;t ki&#x1EC7;m th&#x1EDD;i gian maintain to&#xE0;n b&#x1ED9; m&#x1EA5;y ch&#x1EE5;c service image, c&#x169;ng gi&#xFA;p m&#xEC;nh ti&#x1EBF;t ki&#x1EC7;m th&#x1EDD;i gian build, do nh&#x1EEF;ng th&#x1EE9; l&#x1EB7;p &#x111;i l&#x1EB7;p l&#x1EA1;i nh&#x1B0; vi&#x1EC7;c c&#xE0;i &#x111;&#x1EB7;t m&#xF4;i tr&#x1B0;&#x1EDD;ng &#x111;&#xE3; &#x111;&#x1B0;&#x1EE3;c l&#x1B0;u trong image template r&#x1ED3;i.</p><h2 id="Ket-luan"><a href="#Ket-luan" class="headerlink" title="K&#x1EBF;t lu&#x1EAD;n"></a>K&#x1EBF;t lu&#x1EAD;n</h2><p>&#x110;&#x1EC3; t&#x1ED1;i &#x1B0;u c&#xE1;c b&#x1EA1;n n&#xEA;n quan t&#xE2;m &#x111;&#x1EBF;n 6 &#x111;i&#x1EC1;u n&#xE0;yL</p><ul><li>Ch&#x1ECD;n base image tr&#xEA;n n&#x1EC1;n alpine &#x111;&#x1EC3; dung l&#x1B0;&#x1EE3;ng t&#x1ED1;i &#x1B0;u nh&#x1EA5;t</li><li>S&#x1EAF;p x&#x1EBF;p Dockerfile &#x111;&#x1EC3; t&#x1EAD;n d&#x1EE5;ng layer caching gi&#xFA;p gi&#x1EA3;m th&#x1EDD;i gian build</li><li>G&#x1ED9;p c&#xE1;c c&#xE2;u l&#x1EC7;nh RUN, ADD, COPY c&#xF3; li&#xEA;n quan v&#x1EDB;i nhau &#x111;&#x1EC3; gi&#x1EA3;m s&#x1ED1; layer m&#x1EDB;i</li><li>T&#x1ED1;i &#x1B0;u .dockerignore file &#x111;&#x1EC3; lo&#x1EA1;i b&#x1ECF; nh&#x1EEF;ng file kh&#xF4;ng c&#x1EA7;n thi&#x1EBF;t trong qu&#xE1; tr&#xEC;nh build image</li><li>S&#x1EED; d&#x1EE5;ng multi-stage build &#x111;&#x1EC3; gi&#x1EA3;m dung l&#x1B0;&#x1EE3;ng runtime image</li><li>D&#xF9;ng chung image template b&#x1EB1;ng vi&#x1EC7;c s&#x1EED; d&#x1EE5;ng ONBUILD cho base image gi&#xFA;p ti&#x1EBF;t ki&#x1EC7;m c&#xF4;ng s&#x1EE9;c qu&#x1EA3;n l&#xFD; v&#xE0; th&#x1EDD;i gian build.<br>C&#xE1;m &#x1A1;n c&#xE1;c b&#x1EA1;n &#x111;&#xE3; &#x111;&#x1ECD;c h&#x1EBF;t b&#xE0;i vi&#x1EBF;t c&#x1EE7;a m&#xEC;nh!</li></ul><p>Ngu&#x1ED3;n tham kh&#x1EA3;o : <a href="https://topdev.vn/blog/docker-image-in-production-cau-chuyen-1gb-hay-100mb/" target="_blank" rel="noopener external nofollow noreferrer">TopDev</a></p>
			  		
			  		<!-- google Adsense -->
			  		
					
					
					
					
			    	
					
					<!-- google Adsense Matched content -->
			  		
			  	</div>
				
		  	</article>
		  	
		  	
		  	<!-- TAGS -->
		  	
		  	<div class="meta-content">
				
				<div class="widget">
				  	<h6 class="tag"><span class="fa fa-fw fa-tag"></span>TAGS</h6>
				  	<div class="article-tag">
						<ul class="article-tag-list">
							
					    		<li class="article-tag-list-item">
					    			<a class="article-tag-list-link" href="/tags/Nodejs/">
					    				Nodejs
					    			</a>
					    		</li>
							
					    		<li class="article-tag-list-item">
					    			<a class="article-tag-list-link" href="/tags/Docker/">
					    				Docker
					    			</a>
					    		</li>
							
						</ul>
					</div>
				</div>
				
			</div>
		  	
		  	
		  	<!-- Categories posts -->
		  	
		  	
		  	
		  	<!-- Detailed categories  posts -->
		  	
		  	
		  	
		  	<!-- Latests -->
		  	
			
		</div>
		
		
		<footer id="footer">
		
			
			
			
			
			<div class="copyright-tool">
				
				
				
				<div class="copyright-title">
					<span>
					&copy; 2020&nbsp;Blog Developer
					</span>
				</div>
				
				<div class="copyright-license">
					<aside>
						Powered by <a href="https://hexo.io/">Hexo</a>. <a href="https://github.com/tea3/hexo-generator-amp">AMP-Theme</a> designed by <a href="https://github.com/tea3/">tea</a>.
					</aside>
				</div>
			</div>
			
		</footer>


  	<div id="totop"><a href="#"></a></div>


  </body>
</html>
